import os
import logging
from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import Application, CommandHandler, MessageHandler, filters, ContextTypes, ConversationHandler

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)
logger = logging.getLogger(__name__)

# –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (–ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–ô!)
TOKEN = "BOT_TOKEN"

# –≠—Ç–∞–ø—ã —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
QUESTION, ANSWER = range(2)

# –í–æ–ø—Ä–æ—Å—ã –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
QUESTIONS = [
    {
        "text": "1. –©–æ —Ç–∏ –≤—ñ–¥—á—É–≤–∞—î—à –Ω–∞ —Å–≤–æ—ó–π —Ç–µ–ø–µ—Ä—ñ—à–Ω—ñ–π —Ä–æ–±–æ—Ç—ñ?",
        "options": [
            "A. –í—Ç–æ–º–∞, –Ω—É–¥—å–≥–∞, –≤–Ω—É—Ç—Ä—ñ—à–Ω—î –≤–∏–≥–æ—Ä–∞–Ω–Ω—è.",
            "B. –ú–µ–Ω—ñ –æ–∫, –∞–ª–µ –ø–æ—Å—Ç—ñ–π–Ω–æ –º—Ä—ñ—é –ø—Ä–æ —â–æ—Å—å –±—ñ–ª—å—à–µ.",
            "C. –ü–æ–¥–æ–±–∞—î—Ç—å—Å—è —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å, –∞–ª–µ —â–æ—Å—å —É –º–µ–Ω—ñ —Ö–æ—á–µ –∑–º—ñ–Ω.",
            "D. –Ø –ª—é–±–ª—é —Å–≤–æ—é —Ä–æ–±–æ—Ç—É, —ñ –º–µ–Ω—ñ –Ω–µ —Ö–æ—á–µ—Ç—å—Å—è –Ω—ñ—á–æ–≥–æ –º—ñ–Ω—è—Ç–∏."
        ]
    },
    {
        "text": "2. –Ø–∫ —Ç–∏ —Å—Ç–∞–≤–∏—à—Å—è –¥–æ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–æ—Å—Ç—ñ —Ç–∞ —Ä–∏–∑–∏–∫—ñ–≤?",
        "options": [
            "A. –¶–µ –ª—è–∫–∞—î –º–µ–Ω–µ, —è –Ω–µ –≤–∏—Ç—Ä–∏–º—É—é —Å—Ç—Ä–µ—Å—É.",
            "B. –Ø –Ω–µ –ª—é–±–ª—é —Ä–∏–∑–∏–∫—É–≤–∞—Ç–∏, –∞–ª–µ –º–æ–∂—É, —è–∫—â–æ –¥—É–∂–µ —Ö–æ—á—É —Å–ø—Ä–∞–≤—É.",
            "C. –£ –º—ñ—Ä—É: –≥–æ—Ç–æ–≤–∏–π —Ä–∏–∑–∏–∫—É–≤–∞—Ç–∏, —è–∫—â–æ —î –ø–ª–∞–Ω —ñ —Å–µ–Ω—Å.",
            "D. –Ø —Å–ø–æ–∫—ñ–π–Ω–æ –ø–æ—á—É–≤–∞—é—Å—è –≤ —Ö–∞–æ—Å—ñ, –º–µ–Ω—ñ —Ü—ñ–∫–∞–≤–æ –ø—Ä–æ–±—É–≤–∞—Ç–∏."
        ]
    },
    {
        "text": "3. –©–æ —Ç–∏ –≤—ñ–¥—á—É–≤–∞—î—à, –∫–æ–ª–∏ –±–∞—á–∏—à –ª—é–¥–∏–Ω—É, —è–∫–∞ —Å—Ç–≤–æ—Ä–∏–ª–∞ —Å–≤–æ—é —Å–ø—Ä–∞–≤—É –∑ –Ω—É–ª—è?",
        "options": [
            "A. –î—É–º–∞—é: ¬´–ù—É, —ó–º –ø—Ä–æ—Å—Ç–æ –ø–æ—â–∞—Å—Ç–∏–ª–æ¬ª.",
            "B. –ó–∞–∑–¥—Ä—é —Ç—Ä–æ—Ö–∏, –∞–ª–µ –≤—ñ—Ä—é, —â–æ —ñ —è –∑–º—ñ–≥(–∑–º–æ–≥–ª–∞) –±.",
            "C. –ú–µ–Ω–µ —Ü–µ –Ω–∞–¥–∏—Ö–∞—î –π –≤–º–∏–∫–∞—î —Ü—ñ–∫–∞–≤—ñ—Å—Ç—å.",
            "D. –í –º–µ–Ω—ñ –≤—Å–µ –∑–∞–≥–æ—Ä–∞—î—Ç—å—Å—è ‚Äî —è —Ç–µ–∂ —Ö–æ—á—É!"
        ]
    },
    {
        "text": "4. –Ø–∫ —Ç–∏ –ø—Ä–∏–π–º–∞—î—à —Ä—ñ—à–µ–Ω–Ω—è?",
        "options": [
            "A. –û—á—ñ–∫—É—é —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π –∑–≥–æ—Ä–∏ –∞–±–æ –ø–æ—Ä–∞–¥–∏ –∑–∑–æ–≤–Ω—ñ.",
            "B. –ú–µ–Ω—ñ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞, –∞–ª–µ —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–∏–π–º–∞—é —Å–∞–º(–∞).",
            "C. –ß–∞—Å—Ç–æ –¥—ñ—é —ñ–Ω—Ç—É—ó—Ç–∏–≤–Ω–æ, —ñ —Ü–µ –ø—Ä–∞—Ü—é—î.",
            "D. –Ø —à–≤–∏–¥–∫–æ –ø—Ä–∏–π–º–∞—é —Ä—ñ—à–µ–Ω–Ω—è, –≥–æ—Ç–æ–≤–∏–π(–∞) –Ω–µ—Å—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å."
        ]
    },
    {
        "text": "5. –£—è–≤–∏, —â–æ —Ç–æ–±—ñ –¥–∞–ª–∏ –ø–æ–≤–Ω—É —Å–≤–æ–±–æ–¥—É: –≥—Ä–æ—à—ñ —î, —á–∞—Å —î. –©–æ —Ç–∏ —Ä–æ–±–∏—à?",
        "options": [
            "A. –í—ñ–¥–ø–æ—á–∏–≤–∞—é —Ç–∞ –ø—Ä–æ—Å—Ç–æ –Ω–∞—Å–æ–ª–æ–¥–∂—É—é—Å—å –∂–∏—Ç—Ç—è–º.",
            "B. –®—É–∫–∞—é, —á–∏–º –±–∏ –∑–∞–π–Ω—è—Ç–∏—Å—å, –∞–ª–µ –Ω–µ —Ä–≤—É—Å—å –≤ –±—ñ–∑–Ω–µ—Å.",
            "C. –ü–æ—á–∏–Ω–∞—é –¥–æ—Å–ª—ñ–¥–∂—É–≤–∞—Ç–∏ —Å–≤–æ—ó —ñ–¥–µ—ó –π –ø—Ä–æ–±—É–≤–∞—Ç–∏ –Ω–æ–≤–µ.",
            "D. –í—ñ–¥–∫—Ä–∏–≤–∞—é —Å–≤–æ—é —Å–ø—Ä–∞–≤—É ‚Äî —è –∑–Ω–∞—é, —â–æ —Ö–æ—á—É —Å—Ç–≤–æ—Ä–∏—Ç–∏."
        ]
    },
    {
        "text": "6. –Ø–∫ —Ç–∏ —Å—Ç–∞–≤–∏—à—Å—è –¥–æ —Ä—É—Ç–∏–Ω–∏ —Ç–∞ –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∏—Ö –∑–∞–¥–∞—á?",
        "options": [
            "A. –õ—é–±–ª—é —á—ñ—Ç–∫—ñ—Å—Ç—å, –ø—Ä–æ—Ü–µ—Å–∏, –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è ‚Äî —Ü–µ –¥–∞—î —Å–ø–æ–∫—ñ–π.",
            "B. –¢–µ—Ä–ø–ª—é, –∞–ª–µ —à–≤–∏–¥–∫–æ –≤–∏–≥–æ—Ä–∞—é.",
            "C. –ú–µ–Ω—ñ –≤–∞–∂–∫–æ –±—É—Ç–∏ –≤ —Ä—É—Ç–∏–Ω–∞—Ö ‚Äî –ª—é–±–ª—é —Å–≤–æ–±–æ–¥—É.",
            "D. –ú–µ–Ω–µ —Ü–µ –≤–±–∏–≤–∞—î ‚Äî —è —Ö–æ—á—É —Ç–≤–æ—Ä–∏—Ç–∏, –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏, –≤–ø–ª–∏–≤–∞—Ç–∏."
        ]
    },
    {
        "text": "7. –©–æ –¥–ª—è —Ç–µ–±–µ –≤–∞–∂–ª–∏–≤—ñ—à–µ?",
        "options": [
            "A. –°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å, –∑–∞—Ä–ø–ª–∞—Ç–∞, —Å–æ—Ü—ñ–∞–ª—å–Ω—ñ –≥–∞—Ä–∞–Ω—Ç—ñ—ó.",
            "B. –ë–∞–ª–∞–Ω—Å: —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å + –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø—ñ–¥—Ä–æ–±—ñ—Ç–∫—É.",
            "C. –í–Ω—É—Ç—Ä—ñ—à–Ω—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —ñ —Å–≤–æ–±–æ–¥–∞ ‚Äî –±—ñ–ª—å—à–µ, –Ω—ñ–∂ –≥–∞—Ä–∞–Ω—Ç—ñ—ó.",
            "D. –°–≤–æ–±–æ–¥–∞, —Ä–æ–∑–≤–∏—Ç–æ–∫, –≤–ª–∞—Å–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞. –í—Å–µ —ñ–Ω—à–µ –Ω–µ —Ç–∞–∫ –≤–∞–∂–ª–∏–≤–æ."
        ]
    }
]

# –ë–∞–ª–ª—ã –∑–∞ –æ—Ç–≤–µ—Ç—ã
SCORES = {'A': 1, 'B': 2, 'C': 3, 'D': 4}

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
RESULTS = {
    (7, 11): "üî∏ –¢–æ–±—ñ –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω –±—ñ–∑–Ω–µ—Å.\n\n–ú–æ–∂–ª–∏–≤–æ, —Ç–∏ –ø—Ä–æ—Å—Ç–æ –≤—Ç–æ–º–∏–≤—Å—è/–≤—Ç–æ–º–∏–ª–∞—Å—å, –≤–∏–≥–æ—Ä—ñ–≤/–≤–∏–≥–æ—Ä—ñ–ª–∞, –∞–±–æ –ø–æ—Ç—Ä–∞–ø–∏–≤/–ø–æ—Ç—Ä–∞–ø–∏–ª–∞ –≤ –Ω–µ —Ç—É –∫–æ–º–ø–∞–Ω—ñ—é. –¢–æ–±—ñ –≤–∞–∂–ª–∏–≤–∞ –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω—ñ—Å—Ç—å, –æ–ø–æ—Ä–∞, —Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å.\n\n‚ú® –°–ø—Ä–æ–±—É–π –∑–º—ñ–Ω–∏—Ç–∏ –æ—Ç–æ—á–µ–Ω–Ω—è, –∫–µ—Ä—ñ–≤–Ω–∏–∫–∞, –≥—Ä–∞—Ñ—ñ–∫ ‚Äî –∞ –Ω–µ –∂–∏—Ç—Ç—è –ø–æ–≤–Ω—ñ—Å—Ç—é.",
    (12, 17): "üü† –¢–∏ —â–µ —É –ø–æ—à—É–∫—É.\n\n–ú–æ–∂–ª–∏–≤–æ, —Ç–∏ –≤–∞–≥–∞—î—à—Å—è: –±—ñ–∑–Ω–µ—Å —Ç—è–≥–Ω–µ, –∞–ª–µ –π –±–µ–∑–ø–µ—á–Ω–∞ –∑–æ–Ω–∞ —Ç—Ä–∏–º–∞—î. –ü—Ä–æ–¥–æ–≤–∂—É–π –¥–æ—Å–ª—ñ–¥–∂—É–≤–∞—Ç–∏ —Å–µ–±–µ, –ø—Ä–æ–±—É–π –ø—ñ–¥—Ä–æ–±—ñ—Ç–∫–∏, –Ω–∞–≤—á–∞–Ω–Ω—è, –º–∞–ª–µ–Ω—å–∫—ñ –ø—Ä–æ—î–∫—Ç–∏.\n\n‚ú® –ó–Ω–∞–π–¥–∏ —Ç–æ—á–∫—É —ñ–Ω—Ç–µ—Ä–µ—Å—É ‚Äî —ñ –ø–æ—á–∏–Ω–∞–π —ñ–∑ –º–∞–ª–æ–≥–æ, –Ω–µ –∑–≤—ñ–ª—å–Ω—è—é—á–∏—Å—å –æ–¥—Ä–∞–∑—É.",
    (18, 23): "üü° –£ —Ç–µ–±–µ —î –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª –¥–æ –≤–ª–∞—Å–Ω–æ—ó —Å–ø—Ä–∞–≤–∏.\n\n–¢–∏ –≤–∂–µ —Ä–æ–∑—É–º—ñ—î—à, —â–æ –≤ –Ω–∞–π–º—ñ —Ç–æ–±—ñ —Ç—ñ—Å–Ω–æ. –ú–∞—î—à –≤–Ω—É—Ç—Ä—ñ—à–Ω—é –ø–æ—Ç—Ä–µ–±—É —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ —â–æ—Å—å —Å–≤–æ—î, –∞–ª–µ, –º–æ–∂–ª–∏–≤–æ, —â–µ –±—Ä–∞–∫—É—î –≤–ø–µ–≤–Ω–µ–Ω–æ—Å—Ç—ñ –∞–±–æ –∑–Ω–∞–Ω—å.\n\n‚ú® –¢–≤—ñ–π —à–ª—è—Ö ‚Äî —É —Å—Ç–æ—Ä–æ–Ω—É —Å–≤–æ—î—ó —Å–ø—Ä–∞–≤–∏. –ü–æ—á–∏–Ω–∞–π –±—É–¥—É–≤–∞—Ç–∏ –º—ñ—Å—Ç: –±–µ–∑ —Ä—ñ–∑–∫–∏—Ö —Ä–∏–≤–∫—ñ–≤, –∞–ª–µ –∑ —è—Å–Ω—ñ—Å—Ç—é.",
    (24, 28): "üü¢ –ë—ñ–∑–Ω–µ—Å ‚Äî —Ç–≤–æ—î –ø—Ä–∏—Ä–æ–¥–Ω—î —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ.\n\n–¢–∏ –º–∏—Å–ª–∏—à –Ω–µ–∑–∞–ª–µ–∂–Ω–æ, –ø—Ä–∞–≥–Ω–µ—à —Å–≤–æ–±–æ–¥–∏ –π –≥–ª–∏–±–æ–∫–æ—ó —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó. –†—É—Ç–∏–Ω–∏ —Ç–µ–±–µ –≤–∏—Å–Ω–∞–∂—É—é—Ç—å, –∞ —ñ–¥–µ—ó –∑–∞–ø–∞–ª—é—é—Ç—å.\n\n‚ú® –ù–µ –≥–∞–ª—å–º—É–π: —É —Ç–æ–±—ñ –≤–∂–µ —î –≤—Å–µ, —â–æ–± —Ç–≤–æ—Ä–∏—Ç–∏ —Å–≤–æ—é —Å–ø—Ä–∞–≤—É. –ì–æ–ª–æ–≤–Ω–µ ‚Äî –¥—ñ—è—Ç–∏ –∑ —Ä–æ–∑—É–º–æ–º, –∞ –Ω–µ –∑ –µ–º–æ—Ü—ñ–π."
}

# –•—Ä–∞–Ω–∏–ª–∏—â–µ –æ—Ç–≤–µ—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
user_data = {}

# –ö–æ–º–∞–Ω–¥–∞ /start
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    user_data[user_id] = {'score': 0, 'question_index': 0}
    
    await update.message.reply_text(
        "üß≠ –¢–ï–°–¢: –¢–≤—ñ–π —à–ª—è—Ö ‚Äî –≤–ª–∞—Å–Ω–∞ —Å–ø—Ä–∞–≤–∞ —á–∏ —Å—Ç–∞–±—ñ–ª—å–Ω–∞ —Ä–æ–±–æ—Ç–∞?\n\n"
        "üîπ –û–±–µ—Ä–∏ –æ–¥–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å, —è–∫–∞ –Ω–∞–π–±—ñ–ª—å—à–µ —Ç–æ–±—ñ –≤—ñ–¥–≥—É–∫—É—î—Ç—å—Å—è.\n"
        "üîπ –í –∫—ñ–Ω—Ü—ñ –±—É–¥–µ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.\n\n"
        "–©–æ–± –ø–æ—á–∞—Ç–∏, –æ–±–µ—Ä–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –ø–µ—Ä—à–µ –ø–∏—Ç–∞–Ω–Ω—è:"
    )
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å
    await show_question(update, context, user_id)
    return QUESTION

# –ü–æ–∫–∞–∑ –≤–æ–ø—Ä–æ—Å–∞
async def show_question(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int):
    data = user_data[user_id]
    index = data['question_index']
    
    if index < len(QUESTIONS):
        question = QUESTIONS[index]
        keyboard = [question['options'][i:i+2] for i in range(0, len(question['options']), 2)]
        reply_markup = ReplyKeyboardMarkup(keyboard, resize_keyboard=True, one_time_keyboard=True)
        
        await update.message.reply_text(
            f"{question['text']}\n\n–û–±–µ—Ä–∏ –≤–∞—Ä—ñ–∞–Ω—Ç:",
            reply_markup=reply_markup
        )
    else:
        # –í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –æ—Ç–≤–µ—á–µ–Ω—ã, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        await show_result(update, context, user_id)
        return ConversationHandler.END

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
async def handle_answer(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    answer = update.message.text.strip().upper()[0]  # –ë–µ—Ä–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—É—é –±—É–∫–≤—É (A/B/C/D)
    
    if user_id not in user_data:
        await update.message.reply_text("–©–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫. –ü–æ—á–Ω–∏ —Å–ø–æ—á–∞—Ç–∫—É: /start")
        return ConversationHandler.END
    
    if answer in SCORES:
        # –î–æ–±–∞–≤–ª—è–µ–º –±–∞–ª–ª—ã
        user_data[user_id]['score'] += SCORES[answer]
        # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É
        user_data[user_id]['question_index'] += 1
        
        await show_question(update, context, user_id)
        return QUESTION
    else:
        await update.message.reply_text("–ë—É–¥—å –ª–∞—Å–∫–∞, –æ–±–∏—Ä–∞–π –≤–∞—Ä—ñ–∞–Ω—Ç–∏ A, B, C –∞–±–æ D")
        return QUESTION

# –ü–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
async def show_result(update: Update, context: ContextTypes.DEFAULT_TYPE, user_id: int):
    score = user_data[user_id]['score']
    
    # –ù–∞—Ö–æ–¥–∏–º –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    result_text = ""
    for (min_score, max_score), text in RESULTS.items():
        if min_score <= score <= max_score:
            result_text = text
            break
    
    await update.message.reply_text(
        f"üìä –¢–≤—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: {score} –±–∞–ª—ñ–≤\n\n{result_text}\n\n"
        f"–©–æ–± –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –∑–Ω–æ–≤—É, –Ω–∞–ø–∏—à–∏ /start",
        reply_markup=None
    )
    
    # –£–¥–∞–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if user_id in user_data:
        del user_data[user_id]

# –ö–æ–º–∞–Ω–¥–∞ /cancel
async def cancel(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.effective_user.id
    if user_id in user_data:
        del user_data[user_id]
    
    await update.message.reply_text(
        "–¢–µ—Å—Ç —Å–∫–∞—Å–æ–≤–∞–Ω–æ. –©–æ–± –ø–æ—á–∞—Ç–∏ –∑–Ω–æ–≤—É, –Ω–∞–ø–∏—à–∏ /start"
    )
    return ConversationHandler.END

# –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
def main():
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = Application.builder().token(TOKEN).build()
    
    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–∏–∞–ª–æ–≥–∞
    conv_handler = ConversationHandler(
        entry_points=[CommandHandler('start', start)],
        states={
            QUESTION: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_answer)],
        },
        fallbacks=[CommandHandler('cancel', cancel)],
    )
    
    application.add_handler(conv_handler)
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    logger.info("–ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...")
    application.run_polling(allowed_updates=Update.ALL_TYPES)

if __name__ == '__main__':
    main()
